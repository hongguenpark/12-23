
1) Data Lake Relational Engine Instance에서 HANA DB Instance를 remote server 로 등록

DROP SERVER HANACLOUD;

CREATE SERVER HANACLOUD CLASS 'HANAODBC' USING 
'Driver=libodbcHDB.so;
ConnectTimeout=0;
CommunicationTimeout=15000000;
RECONNECT=0;
ServerNode= 619fb942-ded3-4c89-832a-959ba7891e47.hana.trial-us10.hanacloud.ondemand.com:443;
ENCRYPT=TRUE;
ssltruststore=619fb942-ded3-4c89-832a-959ba7891e47.hana.trial-us10.hanacloud.ondemand.com:443;
ssltrustcert=Yes;
UID=DBADMIN;
PWD=Welcome1';

2) Execute read/write Query to DATALAKE via TEMP TABLE 

SELECT * FROM SBOOK;
TRUNCATE TABLE SBOOK;
SELECT * FROM SBOOK;

DROP TABLE TEMP_SBOOK;
CREATE EXISTING LOCAL TEMPORARY TABLE "TEMP_SBOOK"(
	"MANDT" VARCHAR(3) DEFAULT '000' NOT NULL,
	"CARRID" VARCHAR(3) DEFAULT '' NOT NULL,
	"CONNID" VARCHAR(4) DEFAULT '0000' NOT NULL,
	"FLDATE" VARCHAR(8) DEFAULT '00000000' NOT NULL,
	"BOOKID" VARCHAR(8) DEFAULT '00000000' NOT NULL,
	"CUSTOMID" VARCHAR(8) DEFAULT '00000000' NOT NULL,
	"CUSTTYPE" VARCHAR(1) DEFAULT '' NOT NULL,
	"SMOKER" VARCHAR(1) DEFAULT '' NOT NULL,
	"LUGGWEIGHT" DECIMAL(8, 4) DEFAULT 0 NOT NULL,
	"WUNIT" VARCHAR(3) DEFAULT '' NOT NULL,
	"INVOICE" VARCHAR(1) DEFAULT '' NOT NULL,
	"CLASS" VARCHAR(1) DEFAULT '' NOT NULL,
	"FORCURAM" DECIMAL(15, 2) DEFAULT 0 NOT NULL,
	"FORCURKEY" VARCHAR(5) DEFAULT '' NOT NULL,
	"LOCCURAM" DECIMAL(15, 2) DEFAULT 0 NOT NULL,
	"LOCCURKEY" VARCHAR(5) DEFAULT '' NOT NULL,
	"ORDER_DATE" VARCHAR(8) DEFAULT '00000000' NOT NULL,
	"COUNTER" VARCHAR(8) DEFAULT '00000000' NOT NULL,
	"AGENCYNUM" VARCHAR(8) DEFAULT '00000000' NOT NULL,
	"CANCELLED" VARCHAR(1) DEFAULT '' NOT NULL,
	"RESERVED" VARCHAR(1) DEFAULT '' NOT NULL,
	"PASSNAME" VARCHAR(25) DEFAULT '' NOT NULL,
	"PASSFORM" VARCHAR(15) DEFAULT '' NOT NULL,
	"PASSBIRTH" VARCHAR(8) DEFAULT '00000000' NOT NULL
) AT 'HANACLOUD..SFLIGHT.SBOOK';

SELECT * FROM TEMP_SBOOK;
INSERT INTO SBOOK SELECT * FROM TEMP_SBOOK;
SELECT * FROM SBOOK;
